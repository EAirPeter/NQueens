<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>N Queens</title>
</head>
<body>
<div id="chess-board"></div>

<script src="js/d3.min.js"></script>
<script>
    const cellSize = 40
    const margin = 21

    const chessBoardDiv = d3.select("#chess-board")
    let chessBoardSvg

    function initBoard(a) {

        const boardSize = a * cellSize

        let cells = []
        let locToCell = {}

        for (let row = 0; row < a; row ++) {
            locToCell[row] = {}

            for (let col = 0; col < a; col ++) {
                let cell = {
                    x: row,
                    y: col,
                    defaultFill: ((row % 2 === 0 && col % 2 === 0)
                        || (row % 2 === 1 && col % 2 === 1)) ? "beige" : "tan",
                    fill: undefined,
                    hasQueen: false,
                    available: true
                }
                cells.push(cell)
                locToCell[row][col] = cell
            }
        }

        chessBoardDiv.selectAll("*").remove()

        chessBoardSvg = chessBoardDiv.append("svg")
            .attr("width", `${boardSize + margin}px`)
            .attr("height", `${boardSize + margin}px`)
            .append("g")
            .attr("transform", `translate(${margin}, ${margin})`)

        const chessBoardCells = chessBoardSvg.selectAll(".cells")
            .data(cells)
            .enter()
            .append("g")

        chessBoardCells.append("rect")
            .attr("class", "cell-rect")
            .attr("x", (d) => d.x * cellSize)
            .attr("y", (d) => d.y * cellSize)
            .attr("width", `${cellSize}px`)
            .attr("height", `${cellSize}px`)
            .attr("fill", (d) => d.defaultFill)

        chessBoardCells.append("text")
            .attr("class", "cell-text")
            .attr("x", (d) => d.x * cellSize)
            .attr("y", (d) => d.y * cellSize)

        let colLabels = []
        let rowLabels = []

        for (let row = 0; row < a; row ++) {
            rowLabels.push(row + 1)
        }

        for (let col = 0; col < a; col ++) {
            colLabels.push(numToLetter(col + 1))
        }

        chessBoardSvg.selectAll(".colLabel")
            .data(colLabels)
            .enter().append("text")
            .text((d) => d)
            .attr("y", 0)
            .attr("x", (d, i) => i * cellSize)
            .style("font-size", `${cellSize / 3}px`)
            .style("text-anchor", "middle")
            .style("opacity", 0.75)
            .attr("transform", `translate(${cellSize / 2}, -6)`)

        chessBoardSvg.selectAll(".rowLabel")
            .data(rowLabels)
            .enter().append("text")
            .text((d) => d)
            .attr("y", (d, i) => i * cellSize)
            .attr("x", 0)
            .style("font-size", `${cellSize / 3}px`)
            .style("text-anchor", "middle")
            .style("opacity", 0.75)
            .attr("transform", `translate(-15, ${cellSize / 1.5})`)
    }

    function numToLetter(num) {
        const alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
        let result = ""

        while (num > 0) {
            let charIndex = num % alphabet.length
            num = Math.floor(num / alphabet.length)

            if(charIndex - 1 === -1){
                charIndex = alphabet.length
                num --;
            }

            result = alphabet.charAt(charIndex-1) + result;
        }

        return result
    }

    initBoard(10)
</script>
</body>
</html>